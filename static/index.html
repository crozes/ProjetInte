<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Projet 2017</title>

    <!-- Bootstrap -->
    <!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" crossorigin="anonymous">

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" crossorigin="anonymous"></script>
	<script language="JavaScript" src="https://code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
	<script language="JavaScript" src="https://cdn.datatables.net/1.10.4/js/jquery.dataTables.min.js" type="text/javascript"></script>
	<script language="JavaScript" src="https://cdn.datatables.net/plug-ins/3cfcc339e89/integration/bootstrap/3/dataTables.bootstrap.js" type="text/javascript"></script>

	<link rel="stylesheet" type="text/css" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

	<link rel="stylesheet" type="text/css" href="http://cdn.datatables.net/plug-ins/3cfcc339e89/integration/bootstrap/3/dataTables.bootstrap.css">

	<script src="js/bootstrap-produit.js"></script>
	<script src="js/bootstrap-panneau.js"></script>
	<link href="css/bootstrap-Meteo.css" rel="stylesheet">
    <link href="css/weather-icons.css" rel="stylesheet">
    <link href="css/bootstrap-Spinner.css" rel="stylesheet">
    <link href="css/bootstrap-login.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">

  </head>
  <body>
  	<div id="backGris">
  		<div class="container">
    		<div class="row">
        		<div class="col-md-offset-4 col-md-6">
            		<div class="form-login">
            			<h2>BIENVENUE</h2>
            			<input type="text" id="pseudo" class="form-control input-sm chat-input" placeholder="Pseudo" />
            			</br>
            			
            			<div class="wrapper">
            				<span class="group-btn">     
                				<button class="btn btn-primary btn-md" onclick="newPlayer()">Jouer <i class="fa fa-sign-in"></i></button>
            				</span>
            			</div>
            		</div>
        		</div>
    		</div>
		</div>
  	</div>

    <div id="webPage" class="col-sm-12 container">
		<div class="row">
			<div id="meteo" class="col-sm-3">
				<div id="card" class="weater">
					<div class="city-selected">
						<article>

							<div class="info">
								<div class="city"><span>Jour :</span> <font id="numJourCourrant"></font> / <font id="moment"></font></div>
								<div class="night" id="weather"></div>
								<div class="temp" id="hour"></div>

								<div class="wind">
									

									<span>ville: PERPIGNAN</span>
								</div>
							</div>

							<div class="icon">
								<img 
									id="logoDay1"
    								src="SVG/14.svg" 
    								alt="weather"
    								height="87px"
    								width="80px" 
    							/>
							</div>

						</article>
						
						<figure><img id="imageback" src="images/rainy.png" class="fontImage" /></figure>
					</div>

					<div class="days">
						<div class="row row-no-gutter">
							<div class="col-md-4">
								<div class="day">
									<h1>JOUR 2</h1>
									<h1>AM</h1>
									<img 
    								src="SVG/14_2.svg" 
    								alt="prev1"
    								height="87px"
    								width="80px" 
    							/>
								</div>
							</div>

							<div class="col-md-4">
								<div class="day">
									<h1>JOUR 2</h1>
									<h1>PM</h1>
									<img 
    								src="SVG/18_2.svg" 
    								alt="prev2"
    								height="87px"
    								width="80px" 
    							/>
								</div>
							</div>

							<div class="col-md-4">
								<div class="day">
									<h1>JOUR 3</h1>
									<h1>AM</h1>
									<img 
    								src="SVG/2_2.svg" 
    								alt="prev3"
    								height="87px"
    								width="80px" 
    							/>
								</div>
							</div>

						</div>
					</div>
				</div>
			</div>
			<div id="onglet" class="col-sm-7">
				<div id="tabs">
    				<div class="well">
        				<ul class="nav nav-tabs">
          					<li class="active"><a href="#Stats" data-toggle="tab">Statistiques</a></li>
          					<li><a href="#Cost" data-toggle="tab">Coûts</a></li>
          					<li><a href="#Map" data-toggle="tab" onclick="displayMap(20,20)">Carte</a></li>
          					<li><a href="#Actions" data-toggle="tab" onclick="getActions()">Actions</a></li>
          					<li><a href="#Player" data-toggle="tab" >Joueur en partie</a></li>
          					Budget : <font id="money"></font>
        				</ul>

        				<div id="myTabContent" class="tab-content">
          					<div class="tab-pane active in" id="Stats">
            					<fieldset>
									<legend class="titre_tab">Toute les statistiques</legend>
								</fieldset>
          					</div>
          					<div class="tab-pane fade" id="Cost">
        						Cout matiere premiere et pub : 
          					</div>
          					<div class="tab-pane fade" id="Map">
            					Carte du jeu :
            					<div id="MapPlace">

									</div>
          					</div>
          					<div class="tab-pane fade" id="Actions">
            					<fieldset>

            						<h2>Achat de panneaux publicitaire</h2>
            						<div class="col-sm-12">
										<button type="button" id="add" onclick="addPanneau()" class="btn btn-info col-sm-12">Ajouter un panneaux</button>
             							<table class="col-sm-12 tablePub">
             								<thead>
             									<tr>
             										<td class="listTitre">
             											Panneaux
             										</td>
             										<td class="listTitre">
             											Coordonnées
             										</td>
             										<td class="listTitre">
             											Range
             										</td>
             										<td class="listTitre">
             											Prix
             										</td>
             										<td class="listTitre">
             											
             										</td>
             									</tr>
             								</thead>
             								<tbody id="list">
             								</tbody>
             							</table>
									</div>
									<h2>Achat de cocktails</h2>
									<table id="datatable" class="table table-striped table-bordered" cellspacing="0" width="100%">
    									<thead>
											<tr>
												<th>Cocktail</th>
												<th>Prix</th>
												<th>Nombre à commander</th>
											</tr>
										</thead>

										<tbody id="BuyMP">
											
										</tbody>
									</table>
								</fieldset>
          					</div>
          					<div class="tab-pane fade" id="Player">
           						Liste des joueur en partie avec vous :
          					</div>
        				</div>
    				</div>
				</div>
			</div>
			<div id="evenement" class="col-sm-2">
				<h2>Récapitulatif</h2>
				<p>
					Pseudo :
					<font id="recapPseudo"></font>
				</p>
				<p>
					Jour :
					<font id="recapJour"></font>
				</p>
				<p>
					Meteo :
					<font id="recapMeteo"></font>
				</p>
				<p>
					Budget :
					<font id="recapBudget"></font>
				</p>
				<h3>Achats</h3>
				<table  class="col-sm-12" id="recapTable">
					<thead class="theadTable">
						<tr class="col-sm-12">
							<td class="listTitre">Produit</td>
							<td class="listTitre">Prix</td>
						</tr>
					</thead>
					<tbody class="col-sm-12 tbodyTable" id="recapAchat">
					</tbody>
				</table>
				<BR>
				SOLDE: <font id="budgetTotal">5000</font> - <font id="achatTotal">1000</font> = <font id="resultat">4000€</font>
				<button type="button" id="buttonBuyItems" onclick="buyItems()" class="btn btn-info col-sm-12">Passer commande</button>	
			</div>
		</div>
	</div>


	<script type="text/javascript">

				var CurrentDay = 1;

				function newPlayer(){
					var pseudoJoueur = $('#pseudo').val();
					var dataToSend = {'Player_name': pseudoJoueur};
					$('#recapPseudo').empty();
					$('#recapPseudo').append(pseudoJoueur);
					alert(JSON.stringify(dataToSend));
					$('#backGris').hide();
					$.ajax("http://ponderosaproject.herokuapp.com/newPlayer",{
						type: 'POST',
						contentType: 'application/json',
						data: JSON.stringify(dataToSend),
						success: function (response) {
            				if(response.IsAccepted == true) {
                				//Success si le pseudo n'est pas déjà prit par quelqu'un d'autre.
                				$('#backGris').hide();
                				//Affiche les info de la journée
                				getDayInfo();

            				} else if(response.IsAccepted == false) {
                				//error si le pseudo est déjà pris par qulqu'un d'autre.
                				//$('#backGris').show();
                				alert('Pseudo incorrect: Déjà pris');
            				}
        				}
					});
				}

				var nbDivX = 0;
				var nbDivY = 0;

				function displayMap(x,y){
						nbDivX = 0;
						nbDivY = 0;
						$('#MapPlace').empty();
						for(var i = 0; i < x; i++){
							for(var j = 0; j < y ; j++){
								$('#MapPlace').append('<div class="case" id="' + nbDivY + nbDivX + '"></div>');
								nbDivX +=1;
							}
							nbDivY +=1;
							nbDivX = 0;
							$('#MapPlace').append('<br/>');
						}

						for(var i = 0; i < 10 ; i++){
							var x = Math.floor(Math.random() * 20) + 1 ;
							var y = Math.floor(Math.random() * 20) + 1 
							$('#' + x + '' + y).append('<div class="perso"></div>');
						}
				}

				function getDayInfo(){
					$.ajax('http://ponderosaproject.herokuapp.com/dayinfo').done(function(data){

						var day = data['day'];
						var budget = data['budget'];
						var weather = data['weather'];
						var momentOfDay = data['moment'];

						$('#money').empty();
						$('#money').append('' + budget);
						$('#recapBudget').empty();
						$('#recapBudget').append('' + budget);
						$('#weather').empty();
						$('#weather').append('' + weather);
						$('#recapMeteo').empty();
						$('#recapMeteo').append('' + weather);
						$('#numJourCourrant').empty();
						$('#numJourCourrant').append('' + day);
						$('#recapJour').empty();
						$('#recapJour').append('' + day);
						$('#moment').empty();
						$('#moment').append('' + momentOfDay);

						switch(weather){
							case 'CLOUDY':
								 document.getElementById("logoDay1").src= "SVG/14.svg";
								 document.getElementById("imageback").src = "images/cloudy.png";
								break;
							case 'RAINY':
								 document.getElementById("logoDay1").src= "SVG/18.svg";
								 document.getElementById("imageback").src = "images/rainy.png";
								break;
							case 'SUNNY':
								 document.getElementById("logoDay1").src= "SVG/8.svg";
								 document.getElementById("imageback").src = "images/sunny.png";
								break;
							case 'HEATWAVE':
								 document.getElementById("logoDay1").src= "SVG/2.svg";
								 document.getElementById("imageback").src = "images/heatwave.png";
								break;
							case 'THUNDERSTORM':
								 document.getElementById("logoDay1").src= "SVG/16.svg";
								 document.getElementById("imageback").src = "images/thunderstorm.png";
								break;
							default:
								break;
						}
					});

					getHour();

				}

				function getHour(){
					$.ajax('http://ponderosaproject.herokuapp.com/getHour').done(function(data){
						var madata = JSON.stringify(data);
						var maDataGet = JSON.parse(madata);
						$('#hour').empty();
						$('#hour').append(maDataGet.time + ':00');
					});
					//setInterval(getHour, 5000);
				}

				function getActions(){
					
					$.ajax('http://ponderosaproject.herokuapp.com/coucou').done(function(data){
						//value[]
						$('#BuyMP').empty();
						var classValue = 1;
						//$("#BuyMP").append('');
						//$('#BuyMP').load("html/html-spinner.html"); 

						for(var i in data){
							var madata = JSON.stringify(data[i]);
							var maDataGet = JSON.parse(madata);

							if(classValue == 0)
							{
								classValue = 1;
							}
							else{
								classValue = 0;
							}

							$("#BuyMP").append('<tr list_' + classValue + '"><td id="nomProd_' + i + '" class="col-sm-6">' + maDataGet.nom_test + '</td><td>5€</td><td class="col-sm-4"><div><div class="input-group number-spinner"><span class="input-group-btn"><button onclick="prodMoins(' + i +')" id="prodMoins_' + i + '" class="btn btn-default buttonMoins" data-dir="dwn"><span class="glyphicon glyphicon-minus"></span></button></span><input id="inputProd_' + i + '" type="text" class="form-control text-center" value="0"><span class="input-group-btn"><button onclick="prodPlus(' + i +')" id="prodPlus_' + i + '" class="btn btn-default buttonPlus" data-dir="up"><span class="glyphicon glyphicon-plus"></span></button></span></div></div></td></tr>');

						}
						$('#datatable').dataTable();
					});
				}

	</script>
  </body>
</html>